# SillyTavernchat v1.13.12

åŸºäºSillyTavern 1.13.5çš„å¢å¼ºç‰ˆæœ¬ï¼Œé›†æˆäº†ç”¨æˆ·ç®¡ç†ã€ç³»ç»Ÿç›‘æ§ã€è®ºå›ç¤¾åŒºã€å…¬å‘Šç®¡ç†ç­‰ä¼ä¸šçº§åŠŸèƒ½ã€‚

## ğŸ†• æœ€æ–°æ›´æ–°ï¼ˆV1.13.12ï¼‰

### OAuth ç¬¬ä¸‰æ–¹ç™»å½•ä¼˜åŒ–
- âœ… **ä¿®å¤ Linux.do ç”¨æˆ·åè·å–é—®é¢˜**ï¼šæˆåŠŸè·å–çœŸå®ç”¨æˆ·åï¼ˆå¦‚ `ZhaiKer`ï¼‰ï¼Œä¸å†ä½¿ç”¨é»˜è®¤æ ¼å¼
- âœ… **è‡ªåŠ¨å¤´åƒåŒæ­¥**ï¼šé¦–æ¬¡ç™»å½•è‡ªåŠ¨ä¸‹è½½å¹¶è®¾ç½®ç¬¬ä¸‰æ–¹è´¦å·å¤´åƒï¼Œæ¯æ¬¡ç™»å½•è‡ªåŠ¨æ›´æ–°
- âœ… **çµæ´»çš„ç™»å½•æ–¹å¼**ï¼š
  - OAuth ç”¨æˆ·ï¼ˆæœªè®¾ç½®å¯†ç ï¼‰ï¼šåªèƒ½é€šè¿‡ç¬¬ä¸‰æ–¹ OAuth ç™»å½•
  - OAuth ç”¨æˆ·ï¼ˆå·²è®¾ç½®å¯†ç ï¼‰ï¼šå¯ä½¿ç”¨ OAuth ç™»å½•æˆ–ç”¨æˆ·åå¯†ç ç™»å½•
- âœ… **æ™ºèƒ½å¯†ç è®¾ç½®**ï¼šOAuth ç”¨æˆ·é¦–æ¬¡è®¾ç½®å¯†ç æ—¶æ— éœ€è¾“å…¥æ—§å¯†ç ï¼Œç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«
- âœ… **å‹å¥½çš„ç”¨æˆ·ç•Œé¢**ï¼š
  - ä¸ªäººèµ„æ–™æ˜¾ç¤º OAuth æä¾›å•†ä¿¡æ¯ï¼ˆGitHub / Discord / Linux.doï¼‰
  - ä¿®æ”¹å¯†ç é¡µé¢æ˜¾ç¤º OAuth ç”¨æˆ·å‹å¥½æç¤º
  - ç™»å½•å¤±è´¥æ—¶æä¾›æ¸…æ™°çš„å¼•å¯¼ä¿¡æ¯
- âœ… **å®‰å…¨éªŒè¯ä¼˜åŒ–**ï¼šæ™ºèƒ½åˆ¤æ–­ JWT token æ˜¯å¦åŒ…å«å®Œæ•´ç”¨æˆ·ä¿¡æ¯ï¼Œè‡ªåŠ¨è°ƒç”¨ API è·å–ç”¨æˆ·è¯¦æƒ…

## æ¼”ç¤ºåœ°å€

**https://st.zkjd.me**


**https://ai.cao.baby**

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### ğŸ“Š åŸºäºSillyTavern 1.13.5
- âœ… æ”¯æŒæ‰€æœ‰åŸç‰ˆSillyTavernåŠŸèƒ½
- âœ… é›†æˆæœ€æ–°çš„AIæ¨¡å‹å’ŒAPIæ”¯æŒ
- âœ… MiniMax TTSè¯­éŸ³åˆæˆ
- âœ… Moonshotã€Fireworksã€CometAPIç­‰æ–°APIæº
- âœ… å¢å¼ºçš„Story StringåŒ…è£…åºåˆ—
- âœ… æ”¹è¿›çš„æ‰©å±•ç³»ç»Ÿå’ŒUI/UX

## ğŸš€ äºŒæ¬¡å¼€å‘åŠŸèƒ½

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
- **ç”¨æˆ·æ³¨å†Œä¸ç™»å½•**ï¼šå®Œæ•´çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- **é‚®ç®±æ³¨å†ŒéªŒè¯**ï¼šæ”¯æŒé‚®ç®±éªŒè¯ç æ³¨å†Œï¼ˆV1.13.12 æ–°å¢ï¼‰
  - æ³¨å†Œæ—¶å‘é€é‚®ç®±éªŒè¯ç 
  - éªŒè¯ç 5åˆ†é’Ÿå†…æœ‰æ•ˆ
  - è‡ªåŠ¨ç»‘å®šé‚®ç®±åˆ°ç”¨æˆ·è´¦æˆ·
  - å¦‚æœé‚®ä»¶æœåŠ¡æœªå¯ç”¨ï¼Œåˆ™æ— éœ€é‚®ç®±éªŒè¯å³å¯æ³¨å†Œ
- **é‚®ç®±å¯†ç æ‰¾å›**ï¼šé€šè¿‡é‚®ç®±æ‰¾å›å¯†ç ï¼ˆV1.13.12 æ–°å¢ï¼‰
  - å¦‚æœç”¨æˆ·ç»‘å®šäº†é‚®ç®±ä¸”é‚®ä»¶æœåŠ¡å·²å¯ç”¨ï¼Œæ¢å¤ç å°†å‘é€åˆ°ç”¨æˆ·é‚®ç®±
  - å¦‚æœæœªç»‘å®šé‚®ç®±æˆ–é‚®ä»¶æœåŠ¡æœªå¯ç”¨ï¼Œæ¢å¤ç å°†è¾“å‡ºåˆ°æœåŠ¡å™¨æ§åˆ¶å°
  - æ¢å¤ç 5åˆ†é’Ÿå†…æœ‰æ•ˆ
- **å¯†ç æ¢å¤**ï¼šå¯†ç é‡ç½®åŠŸèƒ½
- **ä¼šè¯ç®¡ç†**ï¼šå®‰å…¨çš„ç”¨æˆ·ä¼šè¯æ§åˆ¶
- **ç”¨æˆ·æ•°æ®éš”ç¦»**ï¼šæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨
- **å­˜å‚¨ç©ºé—´ç›‘æ§**ï¼šå®æ—¶æ˜¾ç¤ºæ¯ä¸ªç”¨æˆ·çš„å­˜å‚¨å ç”¨æƒ…å†µ
- **ç”¨æˆ·é‚®ç®±ä¿¡æ¯**ï¼šç”¨æˆ·é¢æ¿æ˜¾ç¤ºç»‘å®šçš„é‚®ç®±åœ°å€ï¼ˆV1.13.12 æ–°å¢ï¼‰
- **OAuthç¬¬ä¸‰æ–¹æ³¨å†Œç™»å½•**ï¼šæ”¯æŒç¬¬ä¸‰æ–¹è´¦å·å¿«é€Ÿæ³¨å†Œå’Œç™»å½•ï¼ˆV1.13.12 æ–°å¢ï¼‰
  - **æ”¯æŒçš„ OAuth æä¾›å•†**ï¼šGitHubã€Discordã€Linux.do
  - **ä¸€é”®ç™»å½•**ï¼šæ— éœ€è®°ä½å¯†ç ï¼Œå¿«é€Ÿç™»å½•
  - **è‡ªåŠ¨åŒæ­¥ä¿¡æ¯**ï¼šè‡ªåŠ¨åŒæ­¥ç¬¬ä¸‰æ–¹è´¦å·çš„çœŸå®ç”¨æˆ·åã€å¤´åƒå’Œé‚®ç®±
  - **æ™ºèƒ½å¤´åƒç®¡ç†**ï¼šé¦–æ¬¡ç™»å½•è‡ªåŠ¨ä¸‹è½½å¹¶è®¾ç½®ç¬¬ä¸‰æ–¹è´¦å·å¤´åƒï¼Œæ¯æ¬¡ç™»å½•è‡ªåŠ¨æ›´æ–°
  - **çµæ´»çš„ç™»å½•æ–¹å¼**ï¼ˆV1.13.12 ä¼˜åŒ–ï¼‰ï¼š
    - çº¯ OAuth ç”¨æˆ·ï¼ˆæœªè®¾ç½®å¯†ç ï¼‰ï¼šåªèƒ½é€šè¿‡ç¬¬ä¸‰æ–¹ OAuth ç™»å½•
    - OAuth ç”¨æˆ·ï¼ˆå·²è®¾ç½®å¯†ç ï¼‰ï¼šå¯ä»¥ä½¿ç”¨ OAuth ç™»å½•æˆ–ç”¨æˆ·åå¯†ç ç™»å½•
  - **å¯†ç è®¾ç½®åŠŸèƒ½**ï¼šOAuth ç”¨æˆ·å¯åœ¨ä¸ªäººè®¾ç½®ä¸­è®¾ç½®å¯†ç ï¼Œè®¾ç½®åå³å¯ä½¿ç”¨ä¸¤ç§ç™»å½•æ–¹å¼
  - **ä¸é‚€è¯·ç ç³»ç»Ÿå®Œç¾é›†æˆ**ï¼šå¦‚æœå¯ç”¨äº†é‚€è¯·ç ï¼ŒOAuth æ³¨å†Œæ—¶éœ€è¦è¾“å…¥é‚€è¯·ç 
  - **åŠ¨æ€å›è°ƒ URL**ï¼šè‡ªåŠ¨é€‚é…åå‘ä»£ç†å’Œ SSL é…ç½®
  - **å®‰å…¨éªŒè¯**ï¼šä½¿ç”¨ state å‚æ•°é˜²æ­¢ CSRF æ”»å‡»
- **å¤‡ä»½æ–‡ä»¶æ¸…ç†**ï¼šç®¡ç†å‘˜å¯æ¸…ç†ç”¨æˆ·å¤‡ä»½æ–‡ä»¶é‡Šæ”¾ç©ºé—´
  - å•ä¸ªç”¨æˆ·å¤‡ä»½æ¸…ç†ï¼šé’ˆå¯¹ç‰¹å®šç”¨æˆ·æ¸…ç†å¤‡ä»½æ–‡ä»¶
  - æ‰¹é‡å¤‡ä»½æ¸…ç†ï¼šä¸€é”®æ¸…ç†æ‰€æœ‰ç”¨æˆ·çš„å¤‡ä»½æ–‡ä»¶
  - æ™ºèƒ½ç©ºé—´åˆ†æï¼šæ˜¾ç¤ºå„ç±»å‹æ–‡ä»¶çš„å ç”¨æ¯”ä¾‹
  - å®‰å…¨æ¸…ç†ï¼šåªæ¸…ç†å¤‡ä»½æ–‡ä»¶ï¼Œä¿ç•™èŠå¤©è®°å½•å’Œé‡è¦æ•°æ®
- **ä¸€é”®åˆ é™¤60å¤©å†…æœªç™»å½•ç”¨æˆ·å…¨éƒ¨æ•°æ®**ï¼šç®¡ç†å‘˜å¯ä¸€é”®åˆ é™¤60å¤©å†…æœªç™»å½•ç”¨æˆ·å…¨éƒ¨æ•°æ®ï¼ŒåŒ…æ‹¬ç”¨æˆ·æ•°æ®ã€å¤‡ä»½æ–‡ä»¶ã€èŠå¤©è®°å½•ç­‰ã€‚ç”±äºé…’é¦†ç©æ³•å•ä¸€ï¼Œæœ‰äº›ç”¨æˆ·åœ¨ä½¿ç”¨ä¸€æ®µæ—¶é—´å°±æ²¡æœ‰ä»»ä½•ç©ä¸‹å»çš„å…´è¶£ã€‚ä½†æ˜¯å‚¨å­˜æ—¥ç›Šåºå¤§ã€‚ç»è¿‡æµ‹è¯•60å¤©æœªç™»å½•ç”¨æˆ·ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æ²¡æœ‰ç©ä¸‹å»çš„å…´è¶£ï¼Œæ‰€ä»¥è¿™ä¸ªåˆ é™¤60å¤©å†…æœªç™»å½•ç”¨æˆ·å¯¹ç”¨æˆ·ä½“éªŒå¹¶ä¸ä¼šé€ æˆå½±å“ã€‚ï¼ˆV1.13.11 æ–°å¢ï¼‰  2025/11/07æ–°å¢

### ğŸ« é‚€è¯·ç ç³»ç»Ÿ
- **é‚€è¯·ç ç”Ÿæˆ**ï¼šç®¡ç†å‘˜å¯ç”Ÿæˆé‚€è¯·ç 
- **æ³¨å†Œé™åˆ¶**ï¼šé€šè¿‡é‚€è¯·ç æ§åˆ¶ç”¨æˆ·æ³¨å†Œ
- **æœ‰æ•ˆæœŸç®¡ç†**ï¼šæ”¯æŒé‚€è¯·ç è¿‡æœŸæ—¶é—´è®¾ç½®
- **ä½¿ç”¨ç»Ÿè®¡**ï¼šé‚€è¯·ç ä½¿ç”¨æƒ…å†µè·Ÿè¸ª
- **æ‰“å¼€å…³é—­æ–¹å¼**ï¼šæ›´æ”¹æ ¹ç›®å½•./config.yaml  æœç´¢ï¼šenableInvitationCodes: true/false  å¼€/å…³

### ğŸ« é‚€è¯·ç ç³»ç»Ÿæ–°å¢åŠŸèƒ½ ï¼ˆV1.13.10 æ–°å¢åŠŸèƒ½ï¼‰
- **æŒ‰æ—¶é—´é‚€è¯·ç ç”Ÿæˆ**ï¼šå½“ç”¨æˆ·ä½¿ç”¨ä¸€å¤©æœ‰æ•ˆæœŸçš„é‚€è¯·ç æ³¨å†Œï¼Œç”¨æˆ·ä»æ³¨å†Œå¼€å§‹è®¡ç®—ä¸€å¤©ååˆ°æœŸï¼Œä»¥æ­¤ç±»æ¨ã€‚
- **è¿‡æœŸç»­è´¹**ï¼šå½“ç”¨æˆ·è´¦æˆ·è¿‡æœŸåï¼Œç³»ç»Ÿè‡ªåŠ¨è¸¢å‡ºè¿‡æœŸç”¨æˆ·ï¼Œä½¿ç”¨æˆ·é‡æ–°ç™»å½•ï¼Œç™»å½•å¯ä½¿ç”¨æ–°çš„é‚€è¯·ç è¿›è¡Œç»­è´¹è´¦æˆ·ï¼Œç»­è´¹åè´¦æˆ·åˆ°æœŸæ—¶é—´å»¶é•¿ã€‚
- **åå°é…ç½®ç»­è´¹é“¾æ¥**ï¼šç®¡ç†å‘˜å¯åœ¨åå°é…ç½®ç»­è´¹é“¾æ¥ï¼Œç”¨æˆ·åœ¨ç™»å½•é¡µé¢ç‚¹å‡»ç»­è´¹git é“¾æ¥ï¼Œè·³è½¬åˆ°ç»­è´¹é¡µé¢ï¼Œè·å–æ–°çš„é‚€è¯·ç è¿›è¡Œç»­è´¹ã€‚
- **ç»­è´¹åŠŸèƒ½**ï¼šç”¨æˆ·å¯ä½¿ç”¨é‚€è¯·ç ç»­è´¹è´¦æˆ·
- **ç»­è´¹ç ç®¡ç†**ï¼šç®¡ç†å‘˜å¯ç”Ÿæˆç»­è´¹ç 
- **ç»­è´¹ç ä½¿ç”¨**ï¼šç”¨æˆ·å¯ä½¿ç”¨ç»­è´¹ç ç»­è´¹è´¦æˆ·
- **ç»­è´¹ç ä½¿ç”¨ç»Ÿè®¡**ï¼šç»­è´¹ç ä½¿ç”¨æƒ…å†µè·Ÿè¸ª
- **å½“é‚€è¯·ç å…³é—­æ—¶**ï¼šå½“é‚€è¯·ç å…³é—­ï¼Œæ‰€æœ‰æ³¨å†Œç”¨æˆ·é»˜è®¤ä¸ºæ°¸ä¹…ç”¨æˆ·ã€‚å½“é‚€è¯·ç å¼€å¯æ—¶ï¼Œæ‰€æœ‰æ³¨å†Œç”¨æˆ·é»˜è®¤ä¸ºé‚€è¯·ç æœ‰æ•ˆæœŸç”¨æˆ·ã€‚
- **é‚€è¯·ç è®¢é˜…æ—¶é•¿**ï¼šæ”¯æŒ 7 ç§æ—¶é•¿ç±»å‹çš„é‚€è¯·ç ï¼ˆ1å¤©/1å‘¨/1æœˆ/1å­£åº¦/åŠå¹´/1å¹´/æ°¸ä¹…ï¼‰

### ğŸ“¢ å…¬å‘Šç®¡ç†ç³»ç»Ÿ
- **ä¸»ç«™å…¬å‘Š**ï¼šç³»ç»Ÿå†…ç½®å…¬å‘Šå‘å¸ƒåŠŸèƒ½ï¼ˆæ˜¯ç™»é™†åå¼¹çª—å…¬å‘Šï¼‰
  - æ”¯æŒåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤å…¬å‘Š
  - å…¬å‘Šå¯ç”¨/ç¦ç”¨çŠ¶æ€æ§åˆ¶
  - å…¬å‘Šåˆ†ç±»ç®¡ç†ï¼ˆæ•™ç¨‹ã€è®¨è®ºã€å®˜æ–¹å…¬å‘Šç­‰ï¼‰
- **ç™»å½•é¡µé¢å…¬å‘Š**ï¼šç‹¬ç«‹çš„ç™»å½•é¡µé¢å…¬å‘Šç³»ç»Ÿ (V1.13.12 æ–°å¢)ï¼ˆæ˜¯ç™»é™†é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºå…¬å‘Šä¿¡æ¯ï¼‰
  - åœ¨ç™»å½•é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºå…¬å‘Šä¿¡æ¯
  - æ”¯æŒå¤šæ¡å…¬å‘ŠåŒæ—¶æ˜¾ç¤º
  - å…¬å‘Šç±»å‹æ ‡è¯†ï¼ˆä¿¡æ¯/è­¦å‘Š/æˆåŠŸ/é”™è¯¯ï¼‰
  - ä¸ç™»å½•ä¸»é¢˜å®Œç¾èåˆçš„ç¾è§‚è®¾è®¡
  - ç®¡ç†å‘˜åå°ç‹¬ç«‹ç®¡ç†
  - æ— éœ€ç™»å½•å³å¯æŸ¥çœ‹ï¼Œé€‚åˆå‘å¸ƒç»´æŠ¤é€šçŸ¥ã€ä½¿ç”¨è¯´æ˜ç­‰
- **ç®¡ç†åŠŸèƒ½**ï¼š
  - ç®¡ç†å‘˜åå°ç»Ÿä¸€ç®¡ç†ä¸»ç«™å’Œç™»å½•é¡µé¢å…¬å‘Š
  - æ”¯æŒåˆ‡æ¢ä¸åŒå…¬å‘Šç±»å‹è¿›è¡Œç®¡ç†
  - å®æ—¶å¯ç”¨/ç¦ç”¨æ§åˆ¶
  - å…¬å‘Šåˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´è®°å½•

### ğŸ“ˆ ç³»ç»Ÿç›‘æ§
- **å®æ—¶ç³»ç»Ÿè´Ÿè½½ç›‘æ§**ï¼šCPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡
- **ç”¨æˆ·æ´»åŠ¨ç»Ÿè®¡**ï¼šæ¶ˆæ¯æ•°é‡ã€æ´»è·ƒç”¨æˆ·ç»Ÿè®¡
- **å†å²æ•°æ®è®°å½•**ï¼šç³»ç»Ÿæ€§èƒ½å†å²è¶‹åŠ¿
- **å¯è§†åŒ–å›¾è¡¨**ï¼šç›´è§‚çš„æ•°æ®å±•ç¤ºç•Œé¢
- **æ€§èƒ½å‘Šè­¦**ï¼šç³»ç»Ÿèµ„æºä½¿ç”¨å¼‚å¸¸æé†’

### ğŸ’¬ è®ºå›ç¤¾åŒº
- **æ–‡ç« å‘å¸ƒç³»ç»Ÿ**ï¼šæ”¯æŒå¯Œæ–‡æœ¬ç¼–è¾‘
- **åˆ†ç±»ç®¡ç†**ï¼šæ–‡ç« åˆ†ç±»å’Œæ ‡ç­¾ç³»ç»Ÿ
- **è¯„è®ºäº’åŠ¨**ï¼šæ–‡ç« è¯„è®ºå’Œå›å¤åŠŸèƒ½
- **ç”¨æˆ·äº’åŠ¨**ï¼šç‚¹èµã€æ”¶è—ã€åˆ†äº«åŠŸèƒ½
- **å†…å®¹ç®¡ç†**ï¼šç®¡ç†å‘˜å†…å®¹å®¡æ ¸åŠŸèƒ½ï¼ˆå¯ä»¥åˆ é™¤å’Œå…³é—­è®ºå›æ–‡ç« ï¼‰
- **æ‰“å¼€å…³é—­æ–¹å¼**ï¼šæ›´æ”¹æ ¹ç›®å½•./config.yaml  æœç´¢ï¼šenableForum: true/false å¼€/å…³


### ğŸ­ å…¬å…±è§’è‰²å¡åº“
- **è§’è‰²å¡åˆ†äº«**ï¼šç”¨æˆ·å¯åˆ†äº«è‡ªå·±çš„è§’è‰²å¡
- **è§’è‰²å¡æµè§ˆ**ï¼šå…¬å…±è§’è‰²å¡åº“æµè§ˆ
- **æœç´¢å’Œç­›é€‰**ï¼šæŒ‰åˆ†ç±»ã€æ ‡ç­¾æœç´¢è§’è‰²å¡
- **ä¸‹è½½å’Œå¯¼å…¥**ï¼šä¸€é”®ä¸‹è½½å’Œå¯¼å…¥è§’è‰²å¡
- **è¯„åˆ†ç³»ç»Ÿ**ï¼šè§’è‰²å¡è¯„åˆ†å’Œè¯„è®º.
- **æ‰“å¼€å…³é—­æ–¹å¼**ï¼šæ›´æ”¹æ ¹ç›®å½•./config.yaml  æœç´¢ï¼šenablePublicCharacters: true/false  å¼€/å…³

### ğŸ“§ é‚®ä»¶æœåŠ¡ç³»ç»Ÿï¼ˆV1.13.12 æ–°å¢ï¼‰
- **SMTPé‚®ä»¶å‘é€**ï¼šåŸºäº nodemailer çš„é‚®ä»¶æœåŠ¡
- **åå°é‚®ä»¶é…ç½®**ï¼šç®¡ç†å‘˜å¯åœ¨åå°é…ç½®SMTPæœåŠ¡å™¨
  - SMTPæœåŠ¡å™¨åœ°å€å’Œç«¯å£é…ç½®
  - SSL/TLSåŠ å¯†æ”¯æŒ
  - å‘ä»¶äººé‚®ç®±å’Œåç§°è®¾ç½®
  - æµ‹è¯•é‚®ä»¶å‘é€åŠŸèƒ½
- **æ”¯æŒçš„é‚®ç®±æœåŠ¡å•†**ï¼š
  - Gmailï¼ˆéœ€è¦åº”ç”¨ä¸“ç”¨å¯†ç ï¼‰
  - QQé‚®ç®±ï¼ˆéœ€è¦æˆæƒç ï¼‰
  - è…¾è®¯ä¼ä¸šé‚®ç®±ï¼ˆæ”¯æŒSSLï¼‰
  - 163é‚®ç®±ï¼ˆéœ€è¦æˆæƒç ï¼‰
  - Outlook
  - å…¶ä»–æ ‡å‡†SMTPæœåŠ¡
- **æ™ºèƒ½é™çº§**ï¼šå¦‚æœé‚®ä»¶æœåŠ¡æœªå¯ç”¨ï¼Œç³»ç»Ÿè‡ªåŠ¨é™çº§ä¸ºæ§åˆ¶å°è¾“å‡ºæ¨¡å¼
- **é…ç½®ç®¡ç†**ï¼šé…ç½®ä¿å­˜åœ¨ `config.yaml` æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹åéœ€é‡å¯æœåŠ¡ç”Ÿæ•ˆ

### ğŸ¨ ç•Œé¢å¢å¼º
- **å¯¼èˆªé“¾æ¥**ï¼šè§’è‰²å¡é¡µé¢æ–°å¢å¿«æ·å¯¼èˆª
  - æ¬¢è¿é¦–é¡µé“¾æ¥
  - å…±äº«è§’è‰²å¡åº“é“¾æ¥  
  - è®ºå›é“¾æ¥
- **å“åº”å¼è®¾è®¡**ï¼šé€‚é…å„ç§å±å¹•å°ºå¯¸
- **ä¸»é¢˜å…¼å®¹**ï¼šä¸SillyTavernä¸»é¢˜ç³»ç»Ÿå®Œç¾é›†æˆ
- **ç°ä»£åŒ–æ³¨å†Œé¡µé¢**ï¼šå…¨æ–°çš„æ³¨å†Œé¡µé¢è®¾è®¡ï¼ˆV1.13.12 æ–°å¢ï¼‰
  - åˆ†åŒºå¼è¡¨å•å¸ƒå±€
  - å›¾æ ‡åŒ–å­—æ®µæ ‡è¯†
  - æ¸å˜ä¸»é¢˜å’ŒåŠ¨ç”»æ•ˆæœ
  - å“åº”å¼è®¾è®¡ï¼Œé€‚é…PCå’Œç§»åŠ¨ç«¯

## ğŸ”§ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **Node.js + Express**ï¼šæœåŠ¡å™¨æ¡†æ¶
- **node-persist**ï¼šæ•°æ®æŒä¹…åŒ–å­˜å‚¨
- **cookie-session**ï¼šä¼šè¯ç®¡ç†
- **rate-limiter-flexible**ï¼šAPIé™æµä¿æŠ¤
- **multer**ï¼šæ–‡ä»¶ä¸Šä¼ å¤„ç†
- **helmet**ï¼šå®‰å…¨å¤´è®¾ç½®
- **nodemailer**ï¼šé‚®ä»¶å‘é€æœåŠ¡ï¼ˆV1.13.12 æ–°å¢ï¼‰

### å‰ç«¯æŠ€æœ¯æ ˆ
- **åŸç”ŸJavaScript**ï¼šæ— é¢å¤–æ¡†æ¶ä¾èµ–
- **jQuery**ï¼šDOMæ“ä½œå’ŒAJAX
- **FontAwesome**ï¼šå›¾æ ‡ç³»ç»Ÿ
- **CSS3**ï¼šç°ä»£æ ·å¼å’ŒåŠ¨ç”»
- **å“åº”å¼å¸ƒå±€**ï¼šç§»åŠ¨ç«¯é€‚é…

### å®‰å…¨ç‰¹æ€§
- **CSRFä¿æŠ¤**ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ é˜²æŠ¤
- **è¾“å…¥éªŒè¯**ï¼šæœåŠ¡å™¨ç«¯æ•°æ®éªŒè¯
- **SQLæ³¨å…¥é˜²æŠ¤**ï¼šå‚æ•°åŒ–æŸ¥è¯¢
- **XSSé˜²æŠ¤**ï¼šå†…å®¹è¿‡æ»¤å’Œè½¬ä¹‰
- **ä¼šè¯å®‰å…¨**ï¼šå®‰å…¨çš„ä¼šè¯ç®¡ç†

## ğŸ“¦ å®‰è£…éƒ¨ç½²

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18.0.0
- npm >= 8.0.0
- 2GB+ RAM
- 10GB+ ç£ç›˜ç©ºé—´

### å¿«é€Ÿå¼€å§‹
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/zhaiiker/SillyTavernchat.git
cd SillyTavernchat

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨æœåŠ¡
npm start

# æˆ–ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆWindowsï¼‰
Start.bat

# æˆ–åœ¨æ ¹ç›®å½•ä½¿ç”¨æ‰¹å¤„ç†æ–‡ä»¶ï¼ˆLinuxï¼‰
sudo sh start.sh

```


### é…ç½®è¯´æ˜
```yaml
# config.yaml ä¸»è¦é…ç½®é¡¹
listen: true                    # ç›‘å¬å¤–éƒ¨è¿æ¥
port: 8000                     # æœåŠ¡ç«¯å£()
whitelist: []                  # IPç™½åå•
basicAuthMode: false           # åŸºç¡€è®¤è¯æ¨¡å¼
enableExtensions: true        # å¯ç”¨æ‰©å±•ç³»ç»Ÿ
enableInvitationCodes: true   # å¯ç”¨é‚€è¯·ç ç³»ç»Ÿ
enableForum: true             # å¯ç”¨è®ºå›ç³»ç»Ÿ
enablePublicCharacters: true  # å¯ç”¨å…¬å…±è§’è‰²å¡åº“ç³»ç»Ÿ
enableSystemLoadMonitoring: true  # å¯ç”¨ç³»ç»Ÿè´Ÿè½½ç›‘æ§ç³»ç»Ÿ
enableUserActivityStatistics: true  # å¯ç”¨ç”¨æˆ·æ´»åŠ¨ç»Ÿè®¡ç³»ç»Ÿ
enableHistoryDataRecord: true  # å¯ç”¨å†å²æ•°æ®è®°å½•ç³»ç»Ÿ
enableVisualizationChart: true  # å¯ç”¨å¯è§†åŒ–å›¾è¡¨ç³»ç»Ÿ
enablePerformanceAlarm: true  # å¯ç”¨æ€§èƒ½å‘Šè­¦ç³»ç»Ÿ
enableUserManagement: true  # å¯ç”¨ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
enableUserRegistration: true  # å¯ç”¨ç”¨æˆ·æ³¨å†Œç³»ç»Ÿ
enableUserLogin: true  # å¯ç”¨ç”¨æˆ·ç™»å½•ç³»ç»Ÿ
enableUserLogout: true  # å¯ç”¨ç”¨æˆ·æ³¨é”€ç³»ç»Ÿ
enableUserProfile: true  # å¯ç”¨ç”¨æˆ·ä¸ªäººèµ„æ–™ç³»ç»Ÿ
enableUserSettings: true  # å¯ç”¨ç”¨æˆ·è®¾ç½®ç³»ç»Ÿ
enableUserTheme: true  # å¯ç”¨ç”¨æˆ·ä¸»é¢˜ç³»ç»Ÿ

# OAuthç¬¬ä¸‰æ–¹ç™»å½•é…ç½®ï¼ˆV1.13.12 æ–°å¢ï¼‰
oauth:
  github:
    enabled: false            # æ˜¯å¦å¯ç”¨GitHub OAuth
    clientId: ''              # GitHub OAuth App Client ID
    clientSecret: ''          # GitHub OAuth App Client Secret
    callbackUrl: ''           # å›è°ƒURLï¼ˆç•™ç©ºåˆ™è‡ªåŠ¨ç”Ÿæˆï¼Œæ”¯æŒåå‘ä»£ç†ï¼‰
  discord:
    enabled: false            # æ˜¯å¦å¯ç”¨Discord OAuth
    clientId: ''              # Discord OAuth App Client ID
    clientSecret: ''          # Discord OAuth App Client Secret
    callbackUrl: ''           # å›è°ƒURLï¼ˆç•™ç©ºåˆ™è‡ªåŠ¨ç”Ÿæˆï¼Œæ”¯æŒåå‘ä»£ç†ï¼‰
  linuxdo:
    enabled: false            # æ˜¯å¦å¯ç”¨Linux.do OAuth
    clientId: ''              # Linux.do OAuth App Client ID
    clientSecret: ''          # Linux.do OAuth App Client Secret
    callbackUrl: ''           # å›è°ƒURLï¼ˆç•™ç©ºåˆ™è‡ªåŠ¨ç”Ÿæˆï¼Œæ”¯æŒåå‘ä»£ç†ï¼‰
    authUrl: ''               # æˆæƒURLï¼ˆé»˜è®¤ï¼šhttps://connect.linux.do/oauth2/authorizeï¼‰
    tokenUrl: ''              # Token URLï¼ˆé»˜è®¤ï¼šhttps://connect.linux.do/oauth2/tokenï¼‰
    userInfoUrl: ''           # ç”¨æˆ·ä¿¡æ¯URLï¼ˆé»˜è®¤ï¼šhttps://connect.linux.do/api/userï¼‰

# é‚®ä»¶æœåŠ¡é…ç½®ï¼ˆV1.13.12 æ–°å¢ï¼‰
email:
  enabled: false              # æ˜¯å¦å¯ç”¨é‚®ä»¶æœåŠ¡
  smtp:
    host: ''                  # SMTPæœåŠ¡å™¨åœ°å€ï¼ˆå¦‚ï¼šsmtp.qq.comï¼‰
    port: 587                 # SMTPç«¯å£ï¼ˆ465éœ€è¦å¯ç”¨SSLï¼Œ587ä½¿ç”¨STARTTLSï¼‰
    secure: false              # æ˜¯å¦ä½¿ç”¨SSL/TLSï¼ˆç«¯å£465å¿…é¡»ä¸ºtrueï¼‰
    user: ''                   # SMTPç”¨æˆ·åï¼ˆé€šå¸¸æ˜¯é‚®ç®±åœ°å€ï¼‰
    password: ''               # SMTPå¯†ç æˆ–æˆæƒç 
  from: ''                     # å‘ä»¶äººé‚®ç®±åœ°å€
  fromName: 'SillyTavern'     # å‘ä»¶äººåç§°
```

**OAuthé…ç½®è¯´æ˜**ï¼š
- æ”¯æŒ GitHubã€Discordã€Linux.do ä¸‰ç§ OAuth æä¾›å•†
- å›è°ƒ URL å¯ç•™ç©ºï¼Œç³»ç»Ÿä¼šæ ¹æ®å½“å‰è®¿é—®åœ°å€è‡ªåŠ¨ç”Ÿæˆï¼ˆæ”¯æŒåå‘ä»£ç†å’Œ SSLï¼‰
- å¦‚æœå¯ç”¨äº†é‚€è¯·ç ç³»ç»Ÿï¼ŒOAuth æ³¨å†Œæ—¶éœ€è¦è¾“å…¥é‚€è¯·ç 
- é…ç½®ä¿®æ”¹åéœ€è¦é‡å¯æœåŠ¡æ‰èƒ½ç”Ÿæ•ˆ
- è·å– OAuth å‡­è¯ï¼š
  - **GitHub**ï¼šè®¿é—® https://github.com/settings/developers åˆ›å»º OAuth App
  - **Discord**ï¼šè®¿é—® https://discord.com/developers/applications åˆ›å»º OAuth2 åº”ç”¨
  - **Linux.do**ï¼šè”ç³» Linux.do ç®¡ç†å‘˜è·å– OAuth å‡­è¯

**é‚®ä»¶æœåŠ¡é…ç½®è¯´æ˜**ï¼š
- å¯ç”¨é‚®ä»¶æœåŠ¡åï¼Œç”¨æˆ·æ³¨å†Œéœ€è¦é‚®ç®±éªŒè¯ç 
- ç”¨æˆ·å¯†ç æ‰¾å›ä¼šå‘é€æ¢å¤ç åˆ°ç»‘å®šçš„é‚®ç®±
- å¦‚æœé‚®ä»¶æœåŠ¡æœªå¯ç”¨ï¼Œç³»ç»Ÿè‡ªåŠ¨é™çº§ä¸ºæ§åˆ¶å°è¾“å‡ºæ¨¡å¼
- é…ç½®ä¿®æ”¹åéœ€è¦é‡å¯æœåŠ¡æ‰èƒ½ç”Ÿæ•ˆ
- å»ºè®®åœ¨åå°"é‚®ä»¶é…ç½®"é¡µé¢è¿›è¡Œé…ç½®ï¼Œæ”¯æŒæµ‹è¯•é‚®ä»¶å‘é€

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### ç®¡ç†å‘˜é¦–æ¬¡è®¾ç½®
1. å¯åŠ¨ç³»ç»Ÿåè®¿é—® `http://localhost:8000`
2. è¯·ç›´æ¥ç‚¹å‡»ç«‹å³ç™»å½•ï¼Œä¸è¦æ³¨å†Œï¼ä¸è¦æ³¨å†Œã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨æ³¨å†Œä¸€ä¸ªé»˜è®¤ç®¡ç†å‘˜è´¦æˆ·ï¼Œæ˜¯æ²¡æœ‰å¯†ç çš„ã€‚é»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·åä¸ºï¼šdefault-user  å¯†ç ä¸ºç©ºï¼Œç›´æ¥ç‚¹å‡»è¿›å…¥åå°æ·»åŠ æ–°çš„ç®¡ç†å‘˜è´¦æˆ·ï¼
3. åå°æ·»åŠ æ³¨å†Œç¬¬ä¸€ä¸ªç”¨æˆ·ï¼ˆç„¶åå°†æ–°æ³¨å†Œçš„ç”¨æˆ·è¿›è¡Œææƒä¸ºç®¡ç†å‘˜æƒé™ï¼‰
4. é€€å‡ºé»˜è®¤å¸æˆ·ï¼Œç™»å½•æ–°æ·»åŠ çš„ç®¡ç†å‘˜å¸æˆ·ï¼Œå¹¶ç¦ç”¨é»˜è®¤ç”¨æˆ·
5. åœ¨é‚€è¯·ç ç®¡ç†ä¸­ç”Ÿæˆé‚€è¯·ç 
6. é…ç½®è®ºå›åˆ†ç±»å’Œæƒé™è®¾ç½®
7. ï¼ˆå¯é€‰ï¼‰åœ¨å…¬å‘Šç®¡ç†ä¸­å‘å¸ƒç™»å½•é¡µé¢å…¬å‘Šï¼Œå‘ç”¨æˆ·å±•ç¤ºé‡è¦ä¿¡æ¯
8. ï¼ˆå¯é€‰ï¼‰é…ç½®OAuthç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆV1.13.12 æ–°å¢ï¼‰
   - åœ¨ç¬¬ä¸‰æ–¹å¹³å°åˆ›å»º OAuth åº”ç”¨å¹¶è·å– Client ID å’Œ Client Secret
   - ç¼–è¾‘ `config.yaml` æ–‡ä»¶ï¼Œé…ç½®å¯¹åº” OAuth æä¾›å•†çš„å‡­è¯
   - å›è°ƒ URL å¯ç•™ç©ºï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆï¼ˆæ ¼å¼ï¼š`http(s)://åŸŸå:ç«¯å£/api/oauth/æä¾›å•†/callback`ï¼‰
   - é‡å¯æœåŠ¡åï¼Œç™»å½•é¡µé¢å°†æ˜¾ç¤ºå¯¹åº”çš„ OAuth ç™»å½•æŒ‰é’®
9. ï¼ˆå¯é€‰ï¼‰é…ç½®é‚®ä»¶æœåŠ¡ï¼ˆV1.13.12 æ–°å¢ï¼‰
   - è¿›å…¥åå°"é‚®ä»¶é…ç½®"é¡µé¢
   - å¡«å†™SMTPæœåŠ¡å™¨ä¿¡æ¯
   - ç‚¹å‡»"å‘é€æµ‹è¯•é‚®ä»¶"éªŒè¯é…ç½®
   - ä¿å­˜é…ç½®åé‡å¯æœåŠ¡ç”Ÿæ•ˆ
   - å¯ç”¨åï¼Œç”¨æˆ·æ³¨å†Œå°†éœ€è¦é‚®ç®±éªŒè¯ç 

### æ™®é€šç”¨æˆ·ä½¿ç”¨
1. æ³¨å†Œè´¦æˆ·
   - **æ–¹å¼ä¸€ï¼šä¼ ç»Ÿæ³¨å†Œ**ï¼šä½¿ç”¨é‚€è¯·ç æ³¨å†Œè´¦æˆ·
     - å¦‚æœç³»ç»Ÿå¯ç”¨äº†é‚®ä»¶æœåŠ¡ï¼Œéœ€è¦å¡«å†™é‚®ç®±å¹¶è¾“å…¥éªŒè¯ç 
     - éªŒè¯ç ä¼šå‘é€åˆ°æ‚¨å¡«å†™çš„é‚®ç®±ï¼Œ5åˆ†é’Ÿå†…æœ‰æ•ˆ
     - æ³¨å†ŒæˆåŠŸåï¼Œé‚®ç®±ä¼šè‡ªåŠ¨ç»‘å®šåˆ°æ‚¨çš„è´¦æˆ·
   - **æ–¹å¼äºŒï¼šOAuthç¬¬ä¸‰æ–¹ç™»å½•**ï¼ˆV1.13.12 æ–°å¢/ä¼˜åŒ–ï¼‰
     - ç‚¹å‡»ç™»å½•é¡µé¢çš„ GitHubã€Discord æˆ– Linux.do ç™»å½•æŒ‰é’®
     - æˆæƒåè‡ªåŠ¨è·³è½¬å›ç³»ç»Ÿ
     - å¦‚æœå¯ç”¨äº†é‚€è¯·ç ç³»ç»Ÿï¼Œé¦–æ¬¡ç™»å½•éœ€è¦è¾“å…¥é‚€è¯·ç å®Œæˆæ³¨å†Œ
     - ç³»ç»Ÿä¼šè‡ªåŠ¨åŒæ­¥ç¬¬ä¸‰æ–¹è´¦å·çš„çœŸå®ç”¨æˆ·åã€å¤´åƒå’Œé‚®ç®±ä¿¡æ¯
     - OAuth ç”¨æˆ·é»˜è®¤æ— å¯†ç ï¼Œå¯ç›´æ¥é€šè¿‡ç¬¬ä¸‰æ–¹è´¦å·ç™»å½•

2. OAuthç”¨æˆ·è®¾ç½®å¯†ç ï¼ˆV1.13.12 æ–°å¢ï¼‰
   - OAuthç”¨æˆ·å¯åœ¨**ä¸ªäººè®¾ç½® â†’ ä¿®æ”¹å¯†ç **ä¸­è®¾ç½®å¯†ç 
   - **é¦–æ¬¡è®¾ç½®å¯†ç æ— éœ€è¾“å…¥æ—§å¯†ç **ï¼Œç³»ç»Ÿä¼šæ˜¾ç¤ºå‹å¥½æç¤º
   - è®¾ç½®å¯†ç åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹**ä¸¤ç§æ–¹å¼**ç™»å½•ï¼š
     - ç»§ç»­ä½¿ç”¨ç¬¬ä¸‰æ–¹ OAuth ç™»å½•ï¼ˆæ¨èï¼‰
     - ä½¿ç”¨ç”¨æˆ·å + å¯†ç ç™»å½•
   - ä¸ªäººèµ„æ–™é¡µé¢ä¼šæ˜¾ç¤ºæ‚¨çš„ OAuth æä¾›å•†ä¿¡æ¯

3. ç™»å½•æ–¹å¼è¯´æ˜
   - **OAuthç”¨æˆ·ï¼ˆæœªè®¾ç½®å¯†ç ï¼‰**ï¼šåªèƒ½é€šè¿‡ç¬¬ä¸‰æ–¹ OAuth ç™»å½•
   - **OAuthç”¨æˆ·ï¼ˆå·²è®¾ç½®å¯†ç ï¼‰**ï¼šå¯ä½¿ç”¨ OAuth æˆ–å¯†ç ä¸¤ç§æ–¹å¼ç™»å½•
   - **ä¼ ç»Ÿæ³¨å†Œç”¨æˆ·**ï¼šä½¿ç”¨ç”¨æˆ·å + å¯†ç ç™»å½•

4. ä½¿ç”¨ç³»ç»ŸåŠŸèƒ½
   - ç™»å½•ç³»ç»Ÿå¼€å§‹ä½¿ç”¨AIå¯¹è¯åŠŸèƒ½
   - åœ¨è®ºå›ä¸­å‚ä¸ç¤¾åŒºè®¨è®º
   - åˆ†äº«å’Œä¸‹è½½å…¬å…±è§’è‰²å¡
   - ä¸ªæ€§åŒ–è®¾ç½®å’Œä¸»é¢˜é…ç½®

5. å¯†ç æ‰¾å›ï¼ˆV1.13.12 æ–°å¢ï¼‰
   - å¦‚æœå·²ç»‘å®šé‚®ç®±ï¼Œæ¢å¤ç ä¼šå‘é€åˆ°æ‚¨çš„é‚®ç®±
   - å¦‚æœæœªç»‘å®šé‚®ç®±ï¼Œæ¢å¤ç ä¼šæ˜¾ç¤ºåœ¨æœåŠ¡å™¨æ§åˆ¶å°ï¼ˆéœ€è”ç³»ç®¡ç†å‘˜ï¼‰
   - æ¢å¤ç 5åˆ†é’Ÿå†…æœ‰æ•ˆ
   - **æ³¨æ„**ï¼šæœªè®¾ç½®å¯†ç çš„ OAuth ç”¨æˆ·æ— æ³•ä½¿ç”¨å¯†ç æ‰¾å›åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ç¬¬ä¸‰æ–¹è´¦å·ç™»å½•



## ğŸ” OAuth ç¬¬ä¸‰æ–¹ç™»å½•æŠ€æœ¯ç»†èŠ‚ï¼ˆV1.13.12ï¼‰

### å®ç°åŸç†

#### 1. **ç”¨æˆ·åè·å–ä¼˜åŒ–**
- **é—®é¢˜**ï¼šLinux.do è¿”å›çš„ JWT token åªåŒ…å«è®¤è¯ä¿¡æ¯ï¼ˆsub, iss, audï¼‰ï¼Œä¸åŒ…å«ç”¨æˆ·è¯¦ç»†ä¿¡æ¯
- **è§£å†³æ–¹æ¡ˆ**ï¼š
  1. è§£ç  access_token JWTï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å« username ç­‰ç”¨æˆ·ä¿¡æ¯
  2. å¦‚æœåªæœ‰è®¤è¯ä¿¡æ¯ï¼Œè‡ªåŠ¨è°ƒç”¨ `/api/user` ç«¯ç‚¹è·å–å®Œæ•´ç”¨æˆ·æ•°æ®
  3. æ”¯æŒå¤šç§ç”¨æˆ·ä¿¡æ¯å­—æ®µï¼š`username`, `login`, `preferred_username`, `name`
  4. è‡ªåŠ¨å¤„ç†åµŒå¥—æ•°æ®ç»“æ„ï¼ˆ`user.username` æˆ– `username`ï¼‰

#### 2. **å¤´åƒè‡ªåŠ¨åŒæ­¥**
- **é¦–æ¬¡æ³¨å†Œ**ï¼šä¸‹è½½ç¬¬ä¸‰æ–¹è´¦å·å¤´åƒå¹¶è½¬æ¢ä¸º base64 data URL å­˜å‚¨
- **æ¯æ¬¡ç™»å½•**ï¼šè‡ªåŠ¨æ›´æ–°å¤´åƒï¼Œç¡®ä¿æ˜¾ç¤ºæœ€æ–°å¤´åƒ
- **æ”¯æŒæ ¼å¼**ï¼šJPEGã€PNGã€GIFã€WebP ç­‰å¸¸è§å›¾ç‰‡æ ¼å¼
- **é”™è¯¯å¤„ç†**ï¼šå¤´åƒä¸‹è½½å¤±è´¥ä¸å½±å“ç™»å½•æµç¨‹

#### 3. **çµæ´»çš„ç™»å½•æ–¹å¼**
- **åˆ¤æ–­é€»è¾‘**ï¼š
  ```javascript
  if (user.oauthProvider && !user.password && !user.salt) {
    // çº¯ OAuth ç”¨æˆ·ï¼Œåªèƒ½é€šè¿‡ç¬¬ä¸‰æ–¹ç™»å½•
  } else if (user.oauthProvider && user.password && user.salt) {
    // OAuth ç”¨æˆ·å·²è®¾ç½®å¯†ç ï¼Œå¯ä½¿ç”¨ä¸¤ç§æ–¹å¼ç™»å½•
  }
  ```
- **å¯†ç è®¾ç½®**ï¼š
  - OAuth ç”¨æˆ·é¦–æ¬¡è®¾ç½®å¯†ç æ—¶æ— éœ€éªŒè¯æ—§å¯†ç 
  - å‰ç«¯è‡ªåŠ¨éšè—"å½“å‰å¯†ç "è¾“å…¥æ¡†
  - æ˜¾ç¤ºå‹å¥½çš„å¼•å¯¼æç¤ºä¿¡æ¯

#### 4. **å®‰å…¨ç‰¹æ€§**
- **State å‚æ•°**ï¼šé˜²æ­¢ CSRF æ”»å‡»ï¼Œæ¯æ¬¡æˆæƒä½¿ç”¨éšæœºç”Ÿæˆçš„ state
- **JWT éªŒè¯**ï¼šè§£ç å¹¶éªŒè¯ JWT token çš„æœ‰æ•ˆæ€§
- **ä¼šè¯ç®¡ç†**ï¼šOAuth ç™»å½•ååˆ›å»ºå®‰å…¨çš„ç”¨æˆ·ä¼šè¯
- **æƒé™éš”ç¦»**ï¼šOAuth ç”¨æˆ·å’Œä¼ ç»Ÿç”¨æˆ·ä½¿ç”¨ç›¸åŒçš„æƒé™ç³»ç»Ÿ

### æ”¯æŒçš„ OAuth æä¾›å•†

| æä¾›å•† | ç”¨æˆ·åå­—æ®µ | å¤´åƒå­—æ®µ | é‚®ç®±å­—æ®µ | ç‰¹æ®Šè¯´æ˜ |
|--------|-----------|---------|---------|---------|
| **GitHub** | `login` | `avatar_url` | `email` | æ ‡å‡† OAuth2 |
| **Discord** | `username` | `avatar` | `email` | éœ€è¦æ„å»ºå¤´åƒURL |
| **Linux.do** | `username` | `avatar_url` | `email` | ä½¿ç”¨ Discourse API |

### é…ç½®ç¤ºä¾‹

```yaml
oauth:
  linuxdo:
    enabled: true
    clientId: 'your_client_id_here'
    clientSecret: 'your_client_secret_here'
    callbackUrl: ''  # ç•™ç©ºè‡ªåŠ¨ç”Ÿæˆ
    # ä»¥ä¸‹ä¸‰ä¸ªURLå¯ç•™ç©ºä½¿ç”¨é»˜è®¤å€¼
    authUrl: 'https://connect.linux.do/oauth2/authorize'
    tokenUrl: 'https://connect.linux.do/oauth2/token'
    userInfoUrl: 'https://connect.linux.do/api/user'  # ä½¿ç”¨ Discourse API ç«¯ç‚¹
```

### API ç«¯ç‚¹è¯´æ˜

#### OAuth è®¤è¯æµç¨‹
1. **GET** `/api/oauth/:provider` - å‘èµ· OAuth æˆæƒ
2. **GET** `/api/oauth/:provider/callback` - OAuth å›è°ƒå¤„ç†
3. **POST** `/api/oauth/complete-registration` - å®Œæˆé‚€è¯·ç éªŒè¯ï¼ˆå¦‚æœéœ€è¦ï¼‰

#### ç¬¬ä¸‰æ–¹å¹³å°ç«¯ç‚¹ï¼ˆLinux.doï¼‰
- **æˆæƒç«¯ç‚¹**ï¼š`https://connect.linux.do/oauth2/authorize`
- **Tokenç«¯ç‚¹**ï¼š`https://connect.linux.do/oauth2/token`
- **ç”¨æˆ·ä¿¡æ¯ç«¯ç‚¹**ï¼š`https://connect.linux.do/api/user`ï¼ˆè¿”å›å®Œæ•´ç”¨æˆ·æ•°æ®ï¼‰

#### è¿”å›æ•°æ®æ ¼å¼ï¼ˆLinux.doï¼‰
```json
{
  "id": 107981,
  "username": "ZhaiKer",
  "name": "Ker Zhai",
  "email": "user@example.com",
  "avatar_url": "https://linux.do/user_avatar/linux.do/zhaiker/288/493521_2.png",
  "active": true,
  "trust_level": 3,
  "silenced": false
}
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### ç›®å½•ç»“æ„
```
SillyTavernchat/
â”œâ”€â”€ src/                    # åç«¯æºç 
â”‚   â”œâ”€â”€ endpoints/         # APIç«¯ç‚¹
â”‚   â”‚   â”œâ”€â”€ users-public.js  # ç”¨æˆ·å…¬å¼€APIï¼ˆç™»å½•ã€æ³¨å†Œã€å¯†ç æ‰¾å›ï¼‰
â”‚   â”‚   â”œâ”€â”€ users-private.js # ç”¨æˆ·ç§æœ‰APIï¼ˆä¿®æ”¹å¯†ç ã€å¤´åƒã€ä¸ªäººä¿¡æ¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ users-admin.js   # ç”¨æˆ·ç®¡ç†APIï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰
â”‚   â”‚   â”œâ”€â”€ forum.js      # è®ºå›API
â”‚   â”‚   â”œâ”€â”€ system-load.js # ç³»ç»Ÿç›‘æ§API
â”‚   â”‚   â”œâ”€â”€ invitation-codes.js # é‚€è¯·ç API
â”‚   â”‚   â”œâ”€â”€ announcements.js # å…¬å‘Šç®¡ç†API
â”‚   â”‚   â”œâ”€â”€ oauth.js         # OAuthç¬¬ä¸‰æ–¹ç™»å½•APIï¼ˆV1.13.12 æ–°å¢/ä¼˜åŒ–ï¼‰
â”‚   â”‚   â”‚                    # - æ”¯æŒ GitHubã€Discordã€Linux.do
â”‚   â”‚   â”‚                    # - è‡ªåŠ¨å¤´åƒä¸‹è½½å’ŒåŒæ­¥
â”‚   â”‚   â”‚                    # - JWT token è§£æå’Œç”¨æˆ·ä¿¡æ¯è·å–
â”‚   â”‚   â”‚                    # - çµæ´»çš„å¯†ç è®¾ç½®å’Œç™»å½•æ–¹å¼
â”‚   â”‚   â”œâ”€â”€ oauth-config.js  # OAuthé…ç½®ç®¡ç†APIï¼ˆV1.13.12 æ–°å¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ email-config.js  # é‚®ä»¶é…ç½®APIï¼ˆV1.13.12 æ–°å¢ï¼‰
â”‚   â”‚   â””â”€â”€ email-status.js  # é‚®ä»¶æœåŠ¡çŠ¶æ€APIï¼ˆV1.13.12 æ–°å¢ï¼‰
â”‚   â”œâ”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ system-monitor.js  # ç³»ç»Ÿç›‘æ§æ ¸å¿ƒ
â”‚   â”œâ”€â”€ users.js          # ç”¨æˆ·ç®¡ç†æ ¸å¿ƒï¼ˆä¼˜åŒ–äº†OAuthç”¨æˆ·è®¤è¯é€»è¾‘ï¼‰
â”‚   â””â”€â”€ email-service.js   # é‚®ä»¶æœåŠ¡æ ¸å¿ƒï¼ˆV1.13.12 æ–°å¢ï¼‰
â”œâ”€â”€ public/                # å‰ç«¯èµ„æº
â”‚   â”œâ”€â”€ login.html        # ç™»å½•é¡µé¢ï¼ˆæ”¯æŒOAuthç¬¬ä¸‰æ–¹ç™»å½•æŒ‰é’®ï¼‰
â”‚   â”œâ”€â”€ register.html     # æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ forum.html        # è®ºå›é¡µé¢
â”‚   â”œâ”€â”€ public-characters.html # è§’è‰²å¡åº“
â”‚   â””â”€â”€ scripts/          # JavaScriptæ–‡ä»¶
â”‚       â”œâ”€â”€ user.js       # ç”¨æˆ·ç®¡ç†å‰ç«¯ï¼ˆä¼˜åŒ–äº†å¯†ç è®¾ç½®é€»è¾‘ï¼‰
â”‚       â””â”€â”€ templates/    # HTMLæ¨¡æ¿
â”‚           â”œâ”€â”€ userProfile.html  # ä¸ªäººèµ„æ–™ï¼ˆæ˜¾ç¤ºOAuthæä¾›å•†ï¼‰
â”‚           â””â”€â”€ changePassword.html # ä¿®æ”¹å¯†ç è¡¨å•
â””â”€â”€ data/                 # æ•°æ®å­˜å‚¨
    â”œâ”€â”€ default-user/     # é»˜è®¤ç”¨æˆ·æ•°æ®
    â”œâ”€â”€ system-monitor/   # ç›‘æ§æ•°æ®
    â”œâ”€â”€ forum_data/       # è®ºå›æ•°æ®
    â””â”€â”€ announcements/    # å…¬å‘Šæ•°æ®
        â”œâ”€â”€ announcements.json       # ä¸»ç«™å…¬å‘Š
        â””â”€â”€ login_announcements.json # ç™»å½•é¡µé¢å…¬å‘Š
```



## ğŸ¤ è´¡çŒ®æŒ‡å—

### æäº¤ä»£ç 
1. Fork é¡¹ç›®åˆ°æ‚¨çš„GitHubè´¦æˆ·
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼š`git checkout -b feature/æ–°åŠŸèƒ½åç§°`
3. æäº¤æ›´æ”¹ï¼š`git commit -m 'æ·»åŠ æ–°åŠŸèƒ½'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/æ–°åŠŸèƒ½åç§°`
5. åˆ›å»ºPull Request

### æŠ¥å‘Šé—®é¢˜
- ä½¿ç”¨GitHub IssuesæŠ¥å‘Šbug
- æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå¤ç°æ­¥éª¤
- åŒ…å«ç³»ç»Ÿç¯å¢ƒä¿¡æ¯

## ğŸ“„ è®¸å¯è¯
æœ¬é¡¹ç›®åŸºäº AGPL-3.0 è®¸å¯è¯å¼€æºï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢
- [SillyTavern](https://github.com/SillyTavern/SillyTavern) - æä¾›ä¼˜ç§€çš„åŸºç¡€æ¡†æ¶
- æ‰€æœ‰è´¡çŒ®è€…å’Œç¤¾åŒºæˆå‘˜çš„æ”¯æŒ

## ğŸ“ è”ç³»æ–¹å¼
- é¡¹ç›®ä¸»é¡µï¼šhttps://github.com/zhaiiker/SillyTavernchat
- é—®é¢˜åé¦ˆï¼šhttps://github.com/zhaiiker/SillyTavernchat/issues
- è®¨è®ºç¤¾åŒºï¼šhttps://github.com/zhaiiker/SillyTavernchat/discussions

---

**SillyTavernchat** - è®©AIå¯¹è¯æ›´æ™ºèƒ½ï¼Œè®©ç¤¾åŒºæ›´æ´»è·ƒï¼ ğŸ‰
